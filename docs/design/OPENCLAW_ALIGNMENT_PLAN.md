# LurkBot ä¸ OpenClaw å…¨å±€å¯¹é½å®æ–½æ–¹æ¡ˆ

**ç‰ˆæœ¬**: v2.0 (æ›´æ–°ï¼šæ¾„æ¸… Tools vs Skills)
**æ—¥æœŸ**: 2026-01-31
**æ–‡æ¡£è¯­è¨€**: ä¸­æ–‡

**é‡è¦æ›´æ–°**ï¼š
- âœ… æ¾„æ¸…äº† Tools (22ä¸ª) å’Œ Skills (52ä¸ª) çš„æ¦‚å¿µå·®å¼‚
- âœ… LurkBot çš„ 22 ä¸ª Tools å·²å®Œå…¨å®ç°ï¼Œä¸»è¦å·®è·åœ¨ Skills ç”Ÿæ€
- âœ… è°ƒæ•´å®æ–½ç­–ç•¥ï¼šä¼˜å…ˆ Skills è½¬æ¢å’Œ ClawHub é›†æˆ

---

## ç›®å½•

- [ä¸€ã€æˆ˜ç•¥å®šä½ä¸å¯¹é½ç›®æ ‡](#ä¸€æˆ˜ç•¥å®šä½ä¸å¯¹é½ç›®æ ‡)
- [äºŒã€æ¶æ„å¯¹é½åˆ†æ](#äºŒæ¶æ„å¯¹é½åˆ†æ)
- [ä¸‰ã€æ ¸å¿ƒèƒ½åŠ›å¯¹é½è·¯çº¿](#ä¸‰æ ¸å¿ƒèƒ½åŠ›å¯¹é½è·¯çº¿)
- [å››ã€å›½å†…ç”Ÿæ€é€‚é…æ–¹æ¡ˆ](#å››å›½å†…ç”Ÿæ€é€‚é…æ–¹æ¡ˆ)
- [äº”ã€ä¼ä¸šçº§å¢å¼ºè§„åˆ’](#äº”ä¼ä¸šçº§å¢å¼ºè§„åˆ’)
- [å…­ã€å®æ–½è·¯çº¿å›¾](#å…­å®æ–½è·¯çº¿å›¾)
- [ä¸ƒã€é£é™©ç®¡ç†](#ä¸ƒé£é™©ç®¡ç†)
- [å…«ã€æˆåŠŸæ ‡å‡†](#å…«æˆåŠŸæ ‡å‡†)

---

## ä¸€ã€æˆ˜ç•¥å®šä½ä¸å¯¹é½ç›®æ ‡

### 1.1 é¡¹ç›®å®šä½å·®å¼‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚   OpenClaw (TypeScript)              LurkBot (Python)          â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•            â”‚
â”‚                                                                 â”‚
â”‚   ğŸ¯ ç›®æ ‡ç”¨æˆ·                         ğŸ¯ ç›®æ ‡ç”¨æˆ·               â”‚
â”‚      ä¸ªäººç”¨æˆ· + ä¼ä¸š                    å¼€å‘è€… + ä¼ä¸š           â”‚
â”‚                                                                 â”‚
â”‚   ğŸ“± äº¤ä»˜å½¢å¼                         ğŸ“± äº¤ä»˜å½¢å¼               â”‚
â”‚      åŸç”Ÿåº”ç”¨ + CLI + Web               CLI + API + Docker     â”‚
â”‚                                                                 â”‚
â”‚   ğŸŒ éƒ¨ç½²åœºæ™¯                         ğŸŒ éƒ¨ç½²åœºæ™¯               â”‚
â”‚      æ¡Œé¢ + ç§»åŠ¨ + äº‘                   æœåŠ¡å™¨ + å®¹å™¨ + äº‘       â”‚
â”‚                                                                 â”‚
â”‚   ğŸ”§ æŠ€æœ¯ç”Ÿæ€                         ğŸ”§ æŠ€æœ¯ç”Ÿæ€               â”‚
â”‚      Node.js + TypeScript               Python + AI/ML ç”Ÿæ€    â”‚
â”‚                                                                 â”‚
â”‚   ğŸ¨ ç”¨æˆ·ç•Œé¢                         ğŸ¨ ç”¨æˆ·ç•Œé¢               â”‚
â”‚      A2UI Canvas + åŸç”Ÿ UI              Text + CLI + (Web)     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 å¯¹é½æˆ˜ç•¥

**æ ¸å¿ƒåŸåˆ™ï¼šæ¶æ„å¯¹é½ï¼Œç”Ÿæ€å·®å¼‚åŒ–**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¯¹é½æˆ˜ç•¥æ¡†æ¶                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ¯ å®Œå…¨å¯¹é½ (100%)                                              â”‚
â”‚     â”œâ”€â”€ Agent è¿è¡Œæ—¶æ¶æ„                                         â”‚
â”‚     â”œâ”€â”€ ä¹å±‚å·¥å…·ç­–ç•¥ç³»ç»Ÿ                                         â”‚
â”‚     â”œâ”€â”€ WebSocket Gateway åè®®                                  â”‚
â”‚     â”œâ”€â”€ Bootstrap æ–‡ä»¶ç³»ç»Ÿ                                       â”‚
â”‚     â”œâ”€â”€ ä¼šè¯ç®¡ç†æœºåˆ¶                                             â”‚
â”‚     â”œâ”€â”€ å­ä»£ç†é€šä¿¡åè®®                                           â”‚
â”‚     â””â”€â”€ Heartbeat/Cron è‡ªä¸»ç³»ç»Ÿ                                 â”‚
â”‚                                                                 â”‚
â”‚  ğŸ”„ é€‰æ‹©æ€§å¯¹é½ (70%)                                             â”‚
â”‚     â”œâ”€â”€ Skills ç³»ç»Ÿ (ClawHub é›†æˆ)                              â”‚
â”‚     â”œâ”€â”€ A2UI Canvas (ç®€åŒ–ç‰ˆ)                                    â”‚
â”‚     â”œâ”€â”€ é¢‘é“é€‚é…å™¨ (ä¼˜å…ˆå›½å†…)                                    â”‚
â”‚     â””â”€â”€ åŸºç¡€è®¾æ–½æ¨¡å— (å®ç”¨ä¼˜å…ˆ)                                  â”‚
â”‚                                                                 â”‚
â”‚  ğŸš« æ˜ç¡®ä¸å¯¹é½ (0%)                                              â”‚
â”‚     â”œâ”€â”€ åŸç”Ÿåº”ç”¨å¼€å‘                                             â”‚
â”‚     â”œâ”€â”€ è¯­éŸ³å”¤é†’åŠŸèƒ½                                             â”‚
â”‚     â””â”€â”€ å¤æ‚è®¾å¤‡é…å¯¹æµç¨‹                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 å¯¹é½ç›®æ ‡

**æ ¸å¿ƒå‘ç°ï¼šTools vs Skills æ¦‚å¿µå·®å¼‚**

```
OpenClaw æ¶æ„ï¼š
â”œâ”€â”€ Tools (çº¦ 30 ä¸ª) - ç³»ç»Ÿçº§åŸå­åŠŸèƒ½
â””â”€â”€ Skills (52 ä¸ª) - ä¸šåŠ¡çº§åŠŸèƒ½åŒ…è£…ï¼ˆåŒ…å«å¤šä¸ª Toolsï¼‰

LurkBot å½“å‰çŠ¶æ€ï¼š
â”œâ”€â”€ Tools (22 ä¸ª) âœ… å·²å®Œå…¨å®ç°
â””â”€â”€ Skills (3 ä¸ª) ğŸ”„ å¾…æ‰©å±•
```

**å¯¹é½ç›®æ ‡è°ƒæ•´**ï¼š

| ç»´åº¦ | å½“å‰çŠ¶æ€ | ç›®æ ‡çŠ¶æ€ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|---------|--------|------|
| **æ ¸å¿ƒ Tools** | 22/22 (100%) | 22/22 (100%) | âœ… å·²å®Œæˆ | ç³»ç»ŸåŠŸèƒ½å·²é½å…¨ |
| **Skills ç”Ÿæ€** | 3/52 (6%) | 30/52 (58%) | P0 | å¼•å…¥é«˜ä¼˜å…ˆçº§ Skills |
| **ClawHub é›†æˆ** | 0% | 100% | P0 | æ”¯æŒ install/search |
| **å›½å†…é€‚é…** | 0% | 3 ä¸ª Skills | P1 | ä¼ä¸šå¾®ä¿¡/é’‰é’‰/é£ä¹¦ |
| **ä¼ä¸šèƒ½åŠ›** | 60% | 95% | P1 | åŠ å¯†/å®¡è®¡/é«˜å¯ç”¨ |
| **A2UI Canvas** | åè®®å®šä¹‰ | åŸºç¡€æ¸²æŸ“ | P2 | å®ç”¨ä¼˜å…ˆ |

---

## äºŒã€æ¶æ„å¯¹é½åˆ†æ

### 2.1 å½“å‰å¯¹é½çŠ¶æ€è¯„ä¼°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¶æ„æ¨¡å—å¯¹é½çŸ©é˜µ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¨¡å—             â”‚ OpenClaw   â”‚ LurkBot  â”‚ å¯¹é½åº¦     â”‚ å·®è·    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Agent Runtime    â”‚ Pi Agent   â”‚ PydanticAIâ”‚ 95%       â”‚ æ¡†æ¶å·®å¼‚â”‚
â”‚ Tool Policy      â”‚ 9 å±‚       â”‚ 9 å±‚      â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Gateway Protocol â”‚ WebSocket  â”‚ WebSocket â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Session Mgmt     â”‚ JSONL      â”‚ JSONL     â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Bootstrap        â”‚ 8 æ–‡ä»¶     â”‚ 8 æ–‡ä»¶    â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Subagent         â”‚ ACP        â”‚ ACP       â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Heartbeat        â”‚ 10min      â”‚ 5minå¯é…  â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Cron Service     â”‚ 3 è°ƒåº¦ç±»å‹ â”‚ 3 è°ƒåº¦ç±»å‹â”‚ 100%      â”‚ âœ… å®Œå…¨ â”‚
â”‚ Skills System    â”‚ ClawHub    â”‚ æœ¬åœ°åŠ è½½  â”‚ 60%       â”‚ éœ€é›†æˆ  â”‚
â”‚ Channels         â”‚ 13+ é¢‘é“   â”‚ 4 é¢‘é“    â”‚ 30%       â”‚ éœ€æ‰©å±•  â”‚
â”‚ A2UI Canvas      â”‚ å®Œæ•´       â”‚ åè®®å®šä¹‰  â”‚ 40%       â”‚ éœ€æ¸²æŸ“  â”‚
â”‚ Infra Modules    â”‚ 8 æ¨¡å—     â”‚ 8 æ¨¡å—    â”‚ 80%       â”‚ éƒ¨åˆ†å¼±  â”‚
â”‚ Browser Auto     â”‚ Playwright â”‚ Playwrightâ”‚ 90%       â”‚ åŠŸèƒ½å°‘  â”‚
â”‚ TTS              â”‚ 4 æä¾›å•†   â”‚ 4 æä¾›å•†  â”‚ 95%       â”‚ âœ… å¯¹é½ â”‚
â”‚ Memory/Vector    â”‚ ChromaDB   â”‚ ChromaDB  â”‚ 90%       â”‚ âœ… å¯¹é½ â”‚
â”‚ Security/Audit   â”‚ å®Œæ•´       â”‚ åŸºç¡€      â”‚ 60%       â”‚ éœ€å¢å¼º  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•´ä½“å¯¹é½åº¦ï¼š82%                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å…³é”®å·®è·åˆ†æ

#### å·®è· 1: Skills ç”Ÿæ€ç³»ç»Ÿ

**æ ¸å¿ƒé—®é¢˜**ï¼šLurkBot çš„ 22 ä¸ª Tools å·²å®Œå…¨å®ç° âœ…ï¼Œä½†ç¼ºå°‘ Skills ç”Ÿæ€ï¼š

```
LurkBot å½“å‰çŠ¶æ€ï¼š
â”œâ”€â”€ Tools (ç³»ç»ŸåŠŸèƒ½å±‚)ï¼š22/22 (100%) âœ…
â”‚   â””â”€â”€ src/lurkbot/tools/builtin/ - å®Œæ•´å®ç°
â””â”€â”€ Skills (ä¸šåŠ¡åº”ç”¨å±‚)ï¼š3/52 (6%) âŒ
    â””â”€â”€ skills/ - ä»… github/weather/web-search

OpenClaw å¯¹æ¯”ï¼š
â”œâ”€â”€ Tools (ç³»ç»ŸåŠŸèƒ½å±‚)ï¼š~30 ä¸ª
â””â”€â”€ Skills (ä¸šåŠ¡åº”ç”¨å±‚)ï¼š52 ä¸ª âœ…
    â”œâ”€â”€ å†…ç½® Skillsï¼šåŒ…è£… Tools + æ–‡æ¡£
    â””â”€â”€ ClawHub é›†æˆï¼šè¿œç¨‹å®‰è£…
```

**å·®è·æ˜ç»†**ï¼š
- âœ… Tools å±‚å·²å®Œå…¨å¯¹é½ï¼ˆ22 ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼‰
- âŒ Skills å±‚ä¸¥é‡ä¸è¶³ï¼ˆ3 vs 52ï¼‰
- âŒ æ—  ClawHub API å®¢æˆ·ç«¯
- âŒ æ— è¿œç¨‹ Skills ä¸‹è½½èƒ½åŠ›
- âŒ æ—  Skills ç‰ˆæœ¬ç®¡ç†
- âŒ æ—  Skills ä¾èµ–è§£æ

**å®æ–½ç­–ç•¥**ï¼š
1. **Step 0 (å‰ç½®)**: å°† 22 ä¸ª Tools è½¬æ¢ä¸º SKILL.md æ ¼å¼ï¼ˆä¾¿äº ClawHub åˆ†å‘ï¼‰
2. **Step 1**: å®ç° ClawHub å®¢æˆ·ç«¯ï¼ˆæœç´¢/ä¸‹è½½/å®‰è£…ï¼‰
3. **Step 2**: å¼•å…¥ OpenClaw é«˜ä¼˜å…ˆçº§ Skillsï¼ˆ~30 ä¸ªï¼‰

#### å·®è· 2: å›½å†…èŠå¤©åº”ç”¨é€‚é…

**OpenClaw å®ç°**:
```
channels/
â”œâ”€â”€ telegram/      âœ… å®Œæ•´
â”œâ”€â”€ discord/       âœ… å®Œæ•´
â”œâ”€â”€ slack/         âœ… å®Œæ•´
â”œâ”€â”€ whatsapp/      âœ… å®Œæ•´
â”œâ”€â”€ signal/        âœ… å®Œæ•´
â””â”€â”€ imessage/      âœ… å®Œæ•´
```

**LurkBot ç°çŠ¶**:
```
channels/
â”œâ”€â”€ telegram/      âœ… å®Œæ•´
â”œâ”€â”€ discord/       âœ… å®Œæ•´
â”œâ”€â”€ slack/         âœ… å®Œæ•´
â”œâ”€â”€ wework/        âŒ ç¼ºå¤± (ä¼ä¸šå¾®ä¿¡)
â”œâ”€â”€ dingtalk/      âŒ ç¼ºå¤± (é’‰é’‰)
â””â”€â”€ feishu/        âŒ ç¼ºå¤± (é£ä¹¦)
```

**å·®è·åˆ†æ**:
- âŒ å›½å†…ä¸‰å¤§ä¸»æµ IM æœªé€‚é…
- âŒ å›½å†…å¤§æ¨¡å‹å…¼å®¹æ€§æœªéªŒè¯
- âŒ å›½å†…äº‘éƒ¨ç½²æ–‡æ¡£ç¼ºå¤±

#### å·®è· 3: ä¼ä¸šçº§å®‰å…¨å¢å¼º

**OpenClaw å®ç°**:
```typescript
// ä¼šè¯åŠ å¯†
class EncryptedSessionStore {
  encrypt(data: SessionData): Buffer {
    return aes256.encrypt(key, data);
  }
}

// å®¡è®¡æ—¥å¿—
class AuditLogger {
  async log(event: AuditEvent) {
    await db.insert({
      timestamp, userId, action,
      toolName, result, metadata
    });
  }
}
```

**LurkBot ç°çŠ¶**:
```python
# ä¼šè¯æ˜æ–‡å­˜å‚¨
class SessionStore:
    def save(self, session: Session):
        with open(path, 'w') as f:
            json.dump(session.dict(), f)  # âŒ æ˜æ–‡

# å®¡è®¡æ—¥å¿—ç®€å•
class AuditLog:
    def log(self, action: str):
        logger.info(f"Action: {action}")  # âŒ éç»“æ„åŒ–
```

**å·®è·åˆ†æ**:
- âŒ ä¼šè¯æ•°æ®æ˜æ–‡å­˜å‚¨
- âŒ å®¡è®¡æ—¥å¿—éç»“æ„åŒ–
- âŒ æ—  RBAC æƒé™æ¨¡å‹
- âŒ æ— å¤šç§Ÿæˆ·éš”ç¦»

---

## ä¸‰ã€æ ¸å¿ƒèƒ½åŠ›å¯¹é½è·¯çº¿

### 3.1 Skills ç³»ç»Ÿå¢å¼º (P0)

#### 3.1.1 ClawHub é›†æˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LurkBot Skills ç³»ç»Ÿæ¶æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚           lurkbot.skills.clawhub                     â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚       â”‚
â”‚  â”‚  â”‚ ClawHubAPI     â”‚      â”‚ ClawHubCLI      â”‚        â”‚       â”‚
â”‚  â”‚  â”‚ (httpx å®¢æˆ·ç«¯) â”‚      â”‚ (subprocess)    â”‚        â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚       â”‚
â”‚  â”‚           â”‚                       â”‚                 â”‚       â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚       â”‚
â”‚  â”‚                       â”‚                             â”‚       â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚       â”‚
â”‚  â”‚              â”‚ ClawHubClient    â”‚                   â”‚       â”‚
â”‚  â”‚              â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚       â”‚
â”‚  â”‚              â”‚ - search()       â”‚                   â”‚       â”‚
â”‚  â”‚              â”‚ - install()      â”‚                   â”‚       â”‚
â”‚  â”‚              â”‚ - info()         â”‚                   â”‚       â”‚
â”‚  â”‚              â”‚ - sync()         â”‚                   â”‚       â”‚
â”‚  â”‚              â”‚ - resolve_deps() â”‚                   â”‚       â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                         â”‚                                       â”‚
â”‚                         â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚           lurkbot.skills.registry                    â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚       â”‚
â”‚  â”‚  â”‚ SkillRegistry (æ‰©å±•)                   â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ - install_from_clawhub(slug, version) â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ - check_updates()                     â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ - resolve_dependencies()              â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ - verify_signature()                  â”‚          â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.1.2 å®æ–½æ­¥éª¤

**Step 0: å°†ç°æœ‰ Tools è½¬æ¢ä¸º Skills** (2 å¤©)

ä¸º 22 ä¸ª Tools åˆ›å»ºå¯¹åº”çš„ SKILL.md æ–‡ä»¶ï¼Œå»ºç«‹ä» Tools åˆ° Skills çš„æ˜ å°„å…³ç³»ï¼š

```bash
# æ–°å»ºç›®å½•ç»“æ„
skills/
â”œâ”€â”€ exec/SKILL.md              # exec + process tools
â”œâ”€â”€ filesystem/SKILL.md        # read/write/edit/patch tools
â”œâ”€â”€ sessions/SKILL.md          # 6 ä¸ª session ç®¡ç† tools
â”œâ”€â”€ memory/SKILL.md            # memory_search/get tools
â”œâ”€â”€ web/SKILL.md               # web_search/fetch tools
â”œâ”€â”€ messaging/SKILL.md         # message tool
â”œâ”€â”€ automation/SKILL.md        # cron tool
â”œâ”€â”€ gateway/SKILL.md           # gateway tool
â”œâ”€â”€ media/SKILL.md             # image/tts tools
â”œâ”€â”€ nodes/SKILL.md             # nodes tool
â””â”€â”€ hooks/SKILL.md             # hooks tool
```

æ¯ä¸ª SKILL.md åŒ…å«ï¼š
```yaml
---
name: filesystem
description: File system operations (read, write, edit, patch)
version: 1.0.0
tools:
  - read
  - write
  - edit
  - apply_patch
tags: [filesystem, core]
---
# Filesystem Skill

å®Œæ•´çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼ŒåŒ…æ‹¬è¯»å–ã€å†™å…¥ã€ç¼–è¾‘å’Œè¡¥ä¸åº”ç”¨ã€‚

## ä½¿ç”¨ç¤ºä¾‹
[ç”¨æˆ·] è¯»å– config.yaml æ–‡ä»¶
[Bot]  âœ… æ–‡ä»¶å†…å®¹: ...
```

**Step 1: ClawHub API å®¢æˆ·ç«¯** (3 å¤©)

æ–°å»ºæ–‡ä»¶: `src/lurkbot/skills/clawhub.py`

```python
"""ClawHub æŠ€èƒ½æ³¨å†Œä¸­å¿ƒå®¢æˆ·ç«¯"""
import httpx
from pathlib import Path
from pydantic import BaseModel

class ClawHubSkill(BaseModel):
    """ClawHub æŠ€èƒ½å…ƒæ•°æ®"""
    slug: str
    name: str
    version: str
    description: str
    author: str
    downloads: int
    dependencies: list[str] = []
    checksum: str

class ClawHubClient:
    """ClawHub API å®¢æˆ·ç«¯"""

    BASE_URL = "https://api.clawhub.ai/v1"

    async def search(self, query: str) -> list[ClawHubSkill]:
        """æœç´¢æŠ€èƒ½"""
        async with httpx.AsyncClient() as client:
            resp = await client.get(
                f"{self.BASE_URL}/search",
                params={"q": query}
            )
            return [ClawHubSkill(**s) for s in resp.json()["skills"]]

    async def download(self, slug: str, version: str = "latest") -> bytes:
        """ä¸‹è½½æŠ€èƒ½"""
        async with httpx.AsyncClient() as client:
            resp = await client.get(
                f"{self.BASE_URL}/download/{slug}/{version}"
            )
            return resp.content

    async def info(self, slug: str) -> ClawHubSkill:
        """è·å–æŠ€èƒ½ä¿¡æ¯"""
        async with httpx.AsyncClient() as client:
            resp = await client.get(f"{self.BASE_URL}/info/{slug}")
            return ClawHubSkill(**resp.json())
```

**Step 2: CLI å‘½ä»¤æ‰©å±•** (2 å¤©)

æ–°å»ºæ–‡ä»¶: `src/lurkbot/cli/skills.py`

```python
"""æŠ€èƒ½ç®¡ç† CLI å‘½ä»¤"""
import typer
from rich.console import Console
from rich.table import Table

from lurkbot.skills.clawhub import ClawHubClient
from lurkbot.skills.registry import get_skill_manager

app = typer.Typer(help="æŠ€èƒ½ç®¡ç†å‘½ä»¤")
console = Console()

@app.command()
def search(query: str):
    """æœç´¢ ClawHub æŠ€èƒ½"""
    import asyncio

    async def _search():
        client = ClawHubClient()
        skills = await client.search(query)

        table = Table(title=f"æœç´¢ç»“æœ: {query}")
        table.add_column("Slug", style="cyan")
        table.add_column("åç§°", style="green")
        table.add_column("ç‰ˆæœ¬", style="yellow")
        table.add_column("ä¸‹è½½é‡", justify="right")

        for skill in skills:
            table.add_row(
                skill.slug, skill.name,
                skill.version, str(skill.downloads)
            )

        console.print(table)

    asyncio.run(_search())

@app.command()
def install(
    slug: str,
    version: str = "latest",
    workspace: str = "~/.lurkbot"
):
    """å®‰è£…æŠ€èƒ½"""
    import asyncio

    async def _install():
        manager = get_skill_manager()
        await manager.install_from_clawhub(slug, version, workspace)
        console.print(f"âœ… å·²å®‰è£…: {slug}@{version}")

    asyncio.run(_install())

@app.command()
def list(source: str = "all"):
    """åˆ—å‡ºå·²å®‰è£…æŠ€èƒ½"""
    manager = get_skill_manager()
    skills = manager.list_skills()

    table = Table(title="å·²å®‰è£…æŠ€èƒ½")
    table.add_column("Key", style="cyan")
    table.add_column("æ¥æº", style="magenta")
    table.add_column("å¯ç”¨", justify="center")

    for skill in skills:
        if source == "all" or skill.source == source:
            table.add_row(
                skill.key,
                skill.source,
                "âœ…" if skill.frontmatter.enabled else "âŒ"
            )

    console.print(table)
```

**Step 3: Registry æ‰©å±•** (3 å¤©)

ä¿®æ”¹æ–‡ä»¶: `src/lurkbot/skills/registry.py`

```python
class SkillManager:
    """æŠ€èƒ½ç®¡ç†å™¨ (æ‰©å±• ClawHub æ”¯æŒ)"""

    def __init__(self):
        self.registry = SkillRegistry()
        self.clawhub_client = ClawHubClient()

    async def install_from_clawhub(
        self,
        slug: str,
        version: str = "latest",
        workspace: Path | str = "~/.lurkbot"
    ) -> SkillEntry:
        """ä» ClawHub å®‰è£…æŠ€èƒ½"""

        # 1. è·å–æŠ€èƒ½ä¿¡æ¯
        info = await self.clawhub_client.info(slug)

        # 2. æ£€æŸ¥ä¾èµ–
        for dep_slug in info.dependencies:
            if not self.registry.has(dep_slug):
                logger.info(f"å®‰è£…ä¾èµ–: {dep_slug}")
                await self.install_from_clawhub(dep_slug, "latest", workspace)

        # 3. ä¸‹è½½æŠ€èƒ½
        content = await self.clawhub_client.download(slug, version)

        # 4. éªŒè¯ checksum
        import hashlib
        actual_checksum = hashlib.sha256(content).hexdigest()
        if actual_checksum != info.checksum:
            raise ValueError(f"Checksum ä¸åŒ¹é…: {slug}")

        # 5. è§£å‹åˆ° workspace
        workspace_path = Path(workspace).expanduser()
        skill_dir = workspace_path / "skills" / slug
        skill_dir.mkdir(parents=True, exist_ok=True)

        import zipfile
        import io
        with zipfile.ZipFile(io.BytesIO(content)) as zf:
            zf.extractall(skill_dir)

        # 6. åŠ è½½æŠ€èƒ½
        skill = self._load_skill(skill_dir)
        self.registry.register(skill)

        logger.info(f"âœ… å·²å®‰è£…: {slug}@{version}")
        return skill

    async def check_updates(self) -> list[tuple[str, str, str]]:
        """æ£€æŸ¥æŠ€èƒ½æ›´æ–°"""
        updates = []
        for skill in self.registry.list_all():
            if skill.source == "clawhub":
                info = await self.clawhub_client.info(skill.key)
                if info.version > skill.frontmatter.version:
                    updates.append((
                        skill.key,
                        skill.frontmatter.version,
                        info.version
                    ))
        return updates
```

**Step 4: Agent è‡ªåŠ¨å®‰è£…** (2 å¤©)

ä¿®æ”¹æ–‡ä»¶: `src/lurkbot/agents/runtime.py`

```python
async def run_embedded_agent(
    context: AgentContext,
    prompt: str,
    ...
) -> AgentRunResult:
    """è¿è¡Œ Agent (æ”¯æŒè‡ªåŠ¨å®‰è£…æŠ€èƒ½)"""

    # æŠ€èƒ½ç¼ºå¤±æ£€æµ‹
    required_skills = extract_required_skills(prompt)
    for skill_name in required_skills:
        if not skill_manager.registry.has(skill_name):
            logger.info(f"æ£€æµ‹åˆ°ç¼ºå¤±æŠ€èƒ½: {skill_name}")

            # è¯·æ±‚ç”¨æˆ·æ‰¹å‡†
            if context.auto_install_skills:
                await skill_manager.install_from_clawhub(skill_name)
            else:
                # å‘é€å®¡æ‰¹è¯·æ±‚
                approval = await request_skill_install_approval(
                    skill_name, context
                )
                if approval:
                    await skill_manager.install_from_clawhub(skill_name)

    # ... ç»§ç»­åŸæœ‰é€»è¾‘
```

#### 3.1.3 OpenClaw Skills ç”Ÿæ€å¯¹æ¥

**è¿ç§»ç­–ç•¥**:

1. **Phase 1**: å‘å¸ƒ LurkBot æ ¸å¿ƒ Skills åŒ…åˆ° ClawHub (2 å¤©)
   - å°† LurkBot 22 ä¸ª Tools è½¬æ¢ä¸º SKILL.md æ ¼å¼
   - å‘å¸ƒåˆ° ClawHub (å‘½åç©ºé—´: `lurkbot/core-*`)
   - ç›®æ ‡ï¼šè®© LurkBot Tools å¯è¢« OpenClaw ç”Ÿæ€ä½¿ç”¨

2. **Phase 2**: ä» ClawHub å¼•å…¥ OpenClaw é«˜ä¼˜å…ˆçº§ Skills (1 å‘¨)
   - **é«˜ä¼˜å…ˆçº§** (~10 ä¸ª):
     - `openclaw/code-review` - ä»£ç å®¡æŸ¥
     - `openclaw/file-manager` - æ–‡ä»¶ç®¡ç†
     - `openclaw/git-workflow` - Git å·¥ä½œæµ
     - `openclaw/notion` - Notion é›†æˆ
     - `openclaw/slack` - Slack é›†æˆ
   - **ä¸­ä¼˜å…ˆçº§** (~20 ä¸ª):
     - åº”ç”¨é›†æˆ (Trello/Jira/Linear)
     - AI èƒ½åŠ› (Gemini/Whisper)
     - å¼€å‘å·¥å…· (Docker/K8s)
   - ä½¿ç”¨å‘½ä»¤ï¼š`lurkbot skills install openclaw/code-review`

3. **Phase 3**: ç¤¾åŒºæŠ€èƒ½ç”Ÿæ€ (åç»­)
   - ç¼–å†™ Skill å¼€å‘æŒ‡å—æ–‡æ¡£
   - åˆ›å»º Skill æ¨¡æ¿é¡¹ç›®
   - é¼“åŠ±ç”¨æˆ·å‘å¸ƒè‡ªå®šä¹‰ Skills

**é‡è¦è¯´æ˜**ï¼š
- Tools (22ä¸ª) æ˜¯ LurkBot çš„æ ¸å¿ƒä¼˜åŠ¿ âœ…ï¼Œå·²å®Œå…¨å®ç°
- Skills (3â†’30) æ˜¯ç”Ÿæ€æ‰©å±•ç›®æ ‡ï¼Œé€šè¿‡ ClawHub å¿«é€Ÿè¡¥é½
- ä¸éœ€è¦é‡å¤å®ç° Toolsï¼Œåªéœ€åŒ…è£…ä¸º Skills æ ¼å¼

### 3.2 è‡ªä¸»èƒ½åŠ›å¢å¼º (P1)

#### 3.2.1 å½“å‰çŠ¶æ€è¯„ä¼°

| èƒ½åŠ› | OpenClaw | LurkBot | å¯¹é½åº¦ |
|------|----------|---------|--------|
| Heartbeat å‘¨æœŸå”¤é†’ | âœ… 10min | âœ… 5minå¯é… | 100% |
| Cron å®šæ—¶ä»»åŠ¡ | âœ… 3è°ƒåº¦ | âœ… 3è°ƒåº¦ | 100% |
| å­ä»£ç†åä½œ | âœ… ACP | âœ… ACP | 100% |
| **ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«** | âœ… å®Œæ•´ | âŒ ç¼ºå¤± | **0%** |
| **æŠ€èƒ½æ¨èå­¦ä¹ ** | âœ… å®Œæ•´ | âŒ ç¼ºå¤± | **0%** |

#### 3.2.2 ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«ç³»ç»Ÿ

æ–°å»ºç›®å½•: `src/lurkbot/autonomous/proactive/`

```python
# proactive/__init__.py
"""ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«ç³»ç»Ÿ"""

from pydantic import BaseModel
from datetime import datetime

class ProactiveTask(BaseModel):
    """ä¸»åŠ¨è¯†åˆ«çš„ä»»åŠ¡"""
    task_id: str
    description: str
    priority: int  # 1-5
    context: dict
    suggested_time: datetime
    confidence: float  # 0-1

class ProactiveTaskIdentifier:
    """ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«å™¨"""

    def __init__(self, config: ProactiveConfig):
        self.triggers = config.triggers
        self.cooldown = config.cooldown
        self.min_confidence = config.min_confidence

    async def analyze_context(
        self,
        session: Session
    ) -> list[ProactiveTask]:
        """åˆ†æä¼šè¯ä¸Šä¸‹æ–‡ï¼Œè¯†åˆ«æ½œåœ¨ä»»åŠ¡"""

        tasks = []

        # 1. åˆ†ææœ€è¿‘æ¶ˆæ¯
        recent_messages = session.get_recent_messages(limit=20)

        # 2. æå–å¾…åŠäº‹é¡¹
        todos = self._extract_todos(recent_messages)
        for todo in todos:
            tasks.append(ProactiveTask(
                task_id=f"todo-{hash(todo)}",
                description=todo,
                priority=3,
                context={"source": "conversation"},
                suggested_time=datetime.now(),
                confidence=0.8
            ))

        # 3. åˆ†ææ—¶é—´æ¨¡å¼
        time_patterns = self._analyze_time_patterns(session)
        if time_patterns.has_recurring_task:
            tasks.append(ProactiveTask(
                task_id=f"recurring-{time_patterns.pattern_id}",
                description=time_patterns.description,
                priority=4,
                context={"pattern": time_patterns.cron_expr},
                suggested_time=time_patterns.next_occurrence,
                confidence=time_patterns.confidence
            ))

        # 4. æ£€æµ‹å¤±è´¥ä»»åŠ¡
        failed_tools = self._find_failed_tools(recent_messages)
        for tool_name, error in failed_tools:
            tasks.append(ProactiveTask(
                task_id=f"retry-{tool_name}",
                description=f"é‡è¯•å¤±è´¥çš„ä»»åŠ¡: {tool_name}",
                priority=5,
                context={"tool": tool_name, "error": error},
                suggested_time=datetime.now(),
                confidence=0.9
            ))

        return [t for t in tasks if t.confidence >= self.min_confidence]

    async def should_notify(self, task: ProactiveTask) -> bool:
        """åˆ¤æ–­æ˜¯å¦åº”è¯¥é€šçŸ¥ç”¨æˆ·"""

        # æ£€æŸ¥å†·å´æ—¶é—´
        if not self._check_cooldown(task):
            return False

        # æ£€æŸ¥ç”¨æˆ·åœ¨çº¿çŠ¶æ€
        if not await self._is_user_available():
            return False

        return True
```

#### 3.2.3 æŠ€èƒ½è‡ªå­¦ä¹ æœºåˆ¶

æ–°å»ºæ–‡ä»¶: `src/lurkbot/skills/learning.py`

```python
"""æŠ€èƒ½å­¦ä¹ ç®¡ç†å™¨"""

from collections import defaultdict
from datetime import datetime, timedelta

class SkillUsageStats(BaseModel):
    """æŠ€èƒ½ä½¿ç”¨ç»Ÿè®¡"""
    skill_key: str
    total_calls: int
    success_count: int
    failure_count: int
    avg_execution_time: float
    last_used: datetime
    user_rating: float | None = None

class SkillLearningManager:
    """æŠ€èƒ½å­¦ä¹ ç®¡ç†å™¨"""

    def __init__(self):
        self.stats: dict[str, SkillUsageStats] = {}
        self.clawhub_client = ClawHubClient()

    async def suggest_skills(
        self,
        context: AgentContext
    ) -> list[str]:
        """åŸºäºä¸Šä¸‹æ–‡æ¨èæŠ€èƒ½"""

        # 1. åˆ†æç”¨æˆ·æ„å›¾
        intent = self._analyze_intent(context.prompt)

        # 2. æœç´¢ç›¸å…³æŠ€èƒ½
        candidates = await self.clawhub_client.search(intent.keywords)

        # 3. è¿‡æ»¤å·²å®‰è£…
        new_skills = [
            s.slug for s in candidates
            if not skill_manager.registry.has(s.slug)
        ]

        # 4. æ’åº (ä¸‹è½½é‡ + ç›¸å…³åº¦)
        ranked = sorted(
            new_skills,
            key=lambda s: self._relevance_score(s, context),
            reverse=True
        )

        return ranked[:3]

    async def learn_from_usage(
        self,
        skill_key: str,
        feedback: SkillFeedback
    ):
        """ä»ä½¿ç”¨åé¦ˆä¸­å­¦ä¹ """

        if skill_key not in self.stats:
            self.stats[skill_key] = SkillUsageStats(
                skill_key=skill_key,
                total_calls=0,
                success_count=0,
                failure_count=0,
                avg_execution_time=0,
                last_used=datetime.now()
            )

        stats = self.stats[skill_key]
        stats.total_calls += 1
        stats.last_used = datetime.now()

        if feedback.success:
            stats.success_count += 1
        else:
            stats.failure_count += 1

        # æ›´æ–°å¹³å‡æ‰§è¡Œæ—¶é—´
        stats.avg_execution_time = (
            (stats.avg_execution_time * (stats.total_calls - 1) +
             feedback.execution_time) / stats.total_calls
        )

        # ä½æˆåŠŸç‡æŠ€èƒ½æ ‡è®°
        if stats.total_calls >= 5:
            success_rate = stats.success_count / stats.total_calls
            if success_rate < 0.5:
                logger.warning(
                    f"æŠ€èƒ½ {skill_key} æˆåŠŸç‡ä½: {success_rate:.1%}"
                )
```

---

## å››ã€å›½å†…ç”Ÿæ€é€‚é…æ–¹æ¡ˆ

### 4.1 å›½å†…èŠå¤©åº”ç”¨æ¥å…¥æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å›½å†… IM é¢‘é“é€‚é…å±‚æ¶æ„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   ä¼ä¸šå¾®ä¿¡    â”‚  â”‚    é’‰é’‰      â”‚  â”‚    é£ä¹¦      â”‚          â”‚
â”‚  â”‚  WeWork      â”‚  â”‚  DingTalk    â”‚  â”‚   Feishu     â”‚          â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚ - ä¼ä¸šåº”ç”¨   â”‚  â”‚ - ä¼ä¸šå†…éƒ¨   â”‚  â”‚ - ä¼ä¸šè‡ªå»º   â”‚          â”‚
â”‚  â”‚ - Webhook    â”‚  â”‚ - Streamè¿æ¥ â”‚  â”‚ - äº‹ä»¶è®¢é˜…   â”‚          â”‚
â”‚  â”‚ - ä¸»åŠ¨æ¶ˆæ¯   â”‚  â”‚ - æœºå™¨äººæ¶ˆæ¯ â”‚  â”‚ - æ¶ˆæ¯å¡ç‰‡   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                 â”‚                 â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                           â”‚                                    â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                    â”‚BaseIMChannelâ”‚                             â”‚
â”‚                    â”‚  æŠ½è±¡åŸºç±»   â”‚                             â”‚
â”‚                    â”‚             â”‚                             â”‚
â”‚                    â”‚ - send()    â”‚                             â”‚
â”‚                    â”‚ - recv()    â”‚                             â”‚
â”‚                    â”‚ - format()  â”‚                             â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ä¼ä¸šå¾®ä¿¡é€‚é…å™¨

æ–°å»ºç›®å½•: `src/lurkbot/channels/wework/`

```python
# wework/__init__.py
"""ä¼ä¸šå¾®ä¿¡é¢‘é“é€‚é…å™¨"""

from wechatpy.enterprise import WeChatClient
from wechatpy.enterprise.crypto import WeChatCrypto

class WeWorkConfig(BaseModel):
    """ä¼ä¸šå¾®ä¿¡é…ç½®"""
    enabled: bool = False
    corp_id: str  # ä¼ä¸š ID
    agent_id: int  # åº”ç”¨ AgentId
    secret: str  # åº”ç”¨ Secret
    token: str  # å›è°ƒ Token
    encoding_aes_key: str  # åŠ å¯† Key
    allowlist: list[str] = []  # ç™½åå•ç”¨æˆ·

class WeWorkChannel(BaseChannel):
    """ä¼ä¸šå¾®ä¿¡é¢‘é“"""

    def __init__(self, config: WeWorkConfig):
        self.config = config
        self.client = WeChatClient(
            config.corp_id,
            config.secret
        )
        self.crypto = WeChatCrypto(
            config.token,
            config.encoding_aes_key,
            config.corp_id
        )

    async def start(self):
        """å¯åŠ¨ Webhook æœåŠ¡å™¨"""
        from fastapi import FastAPI, Request

        app = FastAPI()

        @app.post("/wework/callback")
        async def callback(request: Request):
            # 1. éªŒè¯ç­¾å
            signature = request.query_params.get("msg_signature")
            timestamp = request.query_params.get("timestamp")
            nonce = request.query_params.get("nonce")

            body = await request.body()
            decrypted = self.crypto.decrypt_message(
                body, signature, timestamp, nonce
            )

            # 2. è§£ææ¶ˆæ¯
            message = parse_wework_message(decrypted)

            # 3. è°ƒç”¨ Agent
            response = await self.handle_message(message)

            # 4. è¿”å›å“åº”
            return self.format_response(response)

        # å¯åŠ¨æœåŠ¡å™¨
        import uvicorn
        uvicorn.run(app, host="0.0.0.0", port=8001)

    async def send(self, message: ChannelMessage):
        """å‘é€æ¶ˆæ¯"""

        # æ”¯æŒæ–‡æœ¬ã€Markdownã€å¡ç‰‡
        if message.format == "markdown":
            self.client.message.send_markdown(
                agent_id=self.config.agent_id,
                user_ids=message.to_user,
                content=message.content
            )
        elif message.format == "card":
            self.client.message.send_template_card(
                agent_id=self.config.agent_id,
                user_ids=message.to_user,
                template_card=message.card_data
            )
        else:
            self.client.message.send_text(
                agent_id=self.config.agent_id,
                user_ids=message.to_user,
                content=message.content
            )
```

### 4.3 é’‰é’‰é€‚é…å™¨

æ–°å»ºç›®å½•: `src/lurkbot/channels/dingtalk/`

```python
# dingtalk/__init__.py
"""é’‰é’‰é¢‘é“é€‚é…å™¨"""

from dingtalk_sdk import DingTalkClient
from dingtalk_stream import AckMessage

class DingTalkConfig(BaseModel):
    """é’‰é’‰é…ç½®"""
    enabled: bool = False
    app_key: str
    app_secret: str
    robot_code: str
    coolapp_code: str | None = None  # é…·åº”ç”¨ Code

class DingTalkChannel(BaseChannel):
    """é’‰é’‰é¢‘é“"""

    def __init__(self, config: DingTalkConfig):
        self.config = config
        self.client = DingTalkClient(
            config.app_key,
            config.app_secret
        )

    async def start(self):
        """å¯åŠ¨ Stream è¿æ¥"""

        # Stream æ¨¡å¼ (é•¿è¿æ¥)
        from dingtalk_stream import DingTalkStreamClient

        stream_client = DingTalkStreamClient(
            client_id=self.config.app_key,
            client_secret=self.config.app_secret
        )

        @stream_client.on_bot_message()
        async def on_message(msg: dict):
            # å¤„ç†æ¶ˆæ¯
            response = await self.handle_message(msg)

            # å›å¤æ¶ˆæ¯
            await self.send(response)

            return AckMessage.STATUS_OK

        # å¯åŠ¨è¿æ¥
        await stream_client.start()

    async def send(self, message: ChannelMessage):
        """å‘é€æ¶ˆæ¯"""

        # æ”¯æŒ Markdownã€ActionCard
        if message.format == "actioncard":
            await self.client.robot.send_action_card(
                webhook=message.webhook,
                title=message.title,
                text=message.content,
                btns=message.buttons
            )
        else:
            await self.client.robot.send_markdown(
                webhook=message.webhook,
                title=message.title,
                text=message.content
            )
```

### 4.4 é£ä¹¦é€‚é…å™¨

æ–°å»ºç›®å½•: `src/lurkbot/channels/feishu/`

```python
# feishu/__init__.py
"""é£ä¹¦é¢‘é“é€‚é…å™¨"""

import lark_oapi as lark
from lark_oapi.api.im.v1 import *

class FeishuConfig(BaseModel):
    """é£ä¹¦é…ç½®"""
    enabled: bool = False
    app_id: str
    app_secret: str
    verification_token: str
    encrypt_key: str | None = None

class FeishuChannel(BaseChannel):
    """é£ä¹¦é¢‘é“"""

    def __init__(self, config: FeishuConfig):
        self.config = config
        self.client = lark.Client.builder() \
            .app_id(config.app_id) \
            .app_secret(config.app_secret) \
            .build()

    async def start(self):
        """å¯åŠ¨äº‹ä»¶è®¢é˜…"""

        from fastapi import FastAPI, Request

        app = FastAPI()

        @app.post("/feishu/event")
        async def event_callback(request: Request):
            # 1. éªŒè¯è¯·æ±‚
            body = await request.json()

            if body.get("type") == "url_verification":
                return {"challenge": body["challenge"]}

            # 2. è§£å¯†äº‹ä»¶
            if self.config.encrypt_key:
                encrypted = body["encrypt"]
                decrypted = self._decrypt_event(encrypted)
                event = json.loads(decrypted)
            else:
                event = body["event"]

            # 3. å¤„ç†æ¶ˆæ¯
            if event["type"] == "message.receive":
                message = event["message"]
                response = await self.handle_message(message)
                await self.send(response)

            return {"code": 0}

        # å¯åŠ¨æœåŠ¡å™¨
        import uvicorn
        uvicorn.run(app, host="0.0.0.0", port=8002)

    async def send(self, message: ChannelMessage):
        """å‘é€æ¶ˆæ¯"""

        # æ„é€ æ¶ˆæ¯å†…å®¹
        if message.format == "card":
            content = lark.MessageCard \
                .builder() \
                .title(message.title) \
                .content(message.content) \
                .build()
        else:
            content = lark.MessageText \
                .builder() \
                .text(message.content) \
                .build()

        # å‘é€æ¶ˆæ¯
        request = CreateMessageRequest.builder() \
            .receive_id_type("chat_id") \
            .receive_id(message.chat_id) \
            .msg_type("interactive" if message.format == "card" else "text") \
            .content(content) \
            .build()

        response = self.client.im.v1.message.create(request)
        return response.success()
```

### 4.5 å›½å†…å¤§æ¨¡å‹å…¼å®¹

ä¿®æ”¹æ–‡ä»¶: `src/lurkbot/config/models.py`

```python
# æ·»åŠ å›½å†…å¤§æ¨¡å‹æä¾›å•†
class ModelProvider(str, Enum):
    ANTHROPIC = "anthropic"
    OPENAI = "openai"
    GOOGLE = "google"
    DEEPSEEK = "deepseek"      # æ–°å¢
    QWEN = "qwen"              # æ–°å¢
    KIMI = "kimi"              # æ–°å¢
    GLM = "glm"                # æ–°å¢

# æ¨¡å‹æ˜ å°„
CHINA_MODELS = {
    "deepseek": {
        "chat": "deepseek-chat",
        "coder": "deepseek-coder"
    },
    "qwen": {
        "max": "qwen-max",
        "plus": "qwen-plus",
        "turbo": "qwen-turbo"
    },
    "kimi": {
        "default": "moonshot-v1-8k"
    },
    "glm": {
        "4": "glm-4",
        "3-turbo": "glm-3-turbo"
    }
}
```

---

## äº”ã€ä¼ä¸šçº§å¢å¼ºè§„åˆ’

### 5.1 å®‰å…¨å¢å¼ºè·¯çº¿å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¼ä¸šçº§å®‰å…¨å¢å¼ºæ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 1: æ•°æ®åŠ å¯†                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ - ä¼šè¯æ•°æ® AES-256 åŠ å¯†                            â”‚          â”‚
â”‚  â”‚ - æ•æ„Ÿé…ç½® Secrets Manager                         â”‚          â”‚
â”‚  â”‚ - ä¼ è¾“å±‚ TLS 1.3                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚  Layer 2: è®¿é—®æ§åˆ¶                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ - RBAC è§’è‰²æƒé™                                    â”‚          â”‚
â”‚  â”‚ - API Token è®¤è¯                                   â”‚          â”‚
â”‚  â”‚ - IP ç™½åå•/é»‘åå•                                 â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚  Layer 3: å®¡è®¡æ—¥å¿—                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ - ç»“æ„åŒ–æ—¥å¿— (JSON Lines)                          â”‚          â”‚
â”‚  â”‚ - æ“ä½œå®¡è®¡è·Ÿè¸ª                                      â”‚          â”‚
â”‚  â”‚ - å¼‚å¸¸è¡Œä¸ºæ£€æµ‹                                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚  Layer 4: åˆè§„æ€§                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ - æ•°æ®æœ¬åœ°åŒ–å­˜å‚¨                                    â”‚          â”‚
â”‚  â”‚ - æ•æ„Ÿè¯è¿‡æ»¤                                        â”‚          â”‚
â”‚  â”‚ - å†…å®¹å®¡æ ¸æ¥å£                                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ä¼šè¯åŠ å¯†å®ç°

æ–°å»ºæ–‡ä»¶: `src/lurkbot/security/encryption.py`

```python
"""ä¼šè¯æ•°æ®åŠ å¯†"""

from cryptography.fernet import Fernet
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2
import base64

class EncryptionManager:
    """åŠ å¯†ç®¡ç†å™¨"""

    def __init__(self, master_key: str):
        """
        åˆå§‹åŒ–åŠ å¯†ç®¡ç†å™¨

        Args:
            master_key: ä¸»å¯†é’¥ (åº”ä»ç¯å¢ƒå˜é‡æˆ– Secrets Manager è·å–)
        """
        self.fernet = self._init_fernet(master_key)

    def _init_fernet(self, master_key: str) -> Fernet:
        """åˆå§‹åŒ– Fernet åŠ å¯†å™¨"""
        # ä½¿ç”¨ PBKDF2 æ´¾ç”Ÿå¯†é’¥
        kdf = PBKDF2(
            algorithm=hashes.SHA256(),
            length=32,
            salt=b"lurkbot-salt-v1",  # ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨éšæœº salt
            iterations=100000,
        )
        key = base64.urlsafe_b64encode(
            kdf.derive(master_key.encode())
        )
        return Fernet(key)

    def encrypt(self, data: str) -> str:
        """åŠ å¯†æ•°æ®"""
        return self.fernet.encrypt(data.encode()).decode()

    def decrypt(self, encrypted: str) -> str:
        """è§£å¯†æ•°æ®"""
        return self.fernet.decrypt(encrypted.encode()).decode()

class EncryptedSessionStore(SessionStore):
    """åŠ å¯†ä¼šè¯å­˜å‚¨"""

    def __init__(self, encryption_manager: EncryptionManager):
        self.encryption = encryption_manager

    def save(self, session: Session):
        """ä¿å­˜åŠ å¯†ä¼šè¯"""
        # åºåˆ—åŒ–
        json_data = session.model_dump_json()

        # åŠ å¯†
        encrypted = self.encryption.encrypt(json_data)

        # å†™å…¥æ–‡ä»¶
        path = self._get_session_path(session.session_id)
        path.write_text(encrypted)

    def load(self, session_id: str) -> Session:
        """åŠ è½½è§£å¯†ä¼šè¯"""
        path = self._get_session_path(session_id)

        # è¯»å–åŠ å¯†æ•°æ®
        encrypted = path.read_text()

        # è§£å¯†
        json_data = self.encryption.decrypt(encrypted)

        # ååºåˆ—åŒ–
        return Session.model_validate_json(json_data)
```

### 5.3 ç»“æ„åŒ–å®¡è®¡æ—¥å¿—

æ–°å»ºæ–‡ä»¶: `src/lurkbot/security/audit.py`

```python
"""ç»“æ„åŒ–å®¡è®¡æ—¥å¿—"""

from enum import Enum
from pathlib import Path
import json

class AuditAction(str, Enum):
    """å®¡è®¡åŠ¨ä½œç±»å‹"""
    AGENT_RUN = "agent.run"
    TOOL_EXEC = "tool.execute"
    SESSION_CREATE = "session.create"
    SESSION_DELETE = "session.delete"
    CONFIG_CHANGE = "config.change"
    SKILL_INSTALL = "skill.install"
    USER_LOGIN = "user.login"
    API_CALL = "api.call"

class AuditLevel(str, Enum):
    """å®¡è®¡çº§åˆ«"""
    INFO = "info"
    WARNING = "warning"
    ERROR = "error"
    CRITICAL = "critical"

class AuditLog(BaseModel):
    """å®¡è®¡æ—¥å¿—æ¡ç›®"""
    timestamp: datetime
    level: AuditLevel
    action: AuditAction
    user_id: str
    session_id: str | None = None
    tool_name: str | None = None
    result: str
    metadata: dict = {}
    ip_address: str | None = None
    user_agent: str | None = None

class AuditLogger:
    """å®¡è®¡æ—¥å¿—è®°å½•å™¨"""

    def __init__(self, log_dir: Path):
        self.log_dir = log_dir
        self.log_dir.mkdir(parents=True, exist_ok=True)

    def log(self, entry: AuditLog):
        """è®°å½•å®¡è®¡æ—¥å¿—"""

        # æŒ‰æ—¥æœŸåˆ†æ–‡ä»¶
        log_file = self.log_dir / f"audit-{entry.timestamp.date()}.jsonl"

        # å†™å…¥ JSON Lines
        with log_file.open("a") as f:
            f.write(entry.model_dump_json() + "\n")

        # åŒæ—¶è®°å½•åˆ°ç³»ç»Ÿæ—¥å¿—
        logger.bind(
            action=entry.action,
            user_id=entry.user_id
        ).info(f"Audit: {entry.action} by {entry.user_id}")

    async def search(
        self,
        start_date: date,
        end_date: date,
        action: AuditAction | None = None,
        user_id: str | None = None
    ) -> list[AuditLog]:
        """æœç´¢å®¡è®¡æ—¥å¿—"""

        results = []
        current_date = start_date

        while current_date <= end_date:
            log_file = self.log_dir / f"audit-{current_date}.jsonl"

            if log_file.exists():
                with log_file.open("r") as f:
                    for line in f:
                        entry = AuditLog.model_validate_json(line)

                        # è¿‡æ»¤
                        if action and entry.action != action:
                            continue
                        if user_id and entry.user_id != user_id:
                            continue

                        results.append(entry)

            current_date += timedelta(days=1)

        return results
```

### 5.4 RBAC æƒé™æ¨¡å‹

æ–°å»ºæ–‡ä»¶: `src/lurkbot/security/rbac.py`

```python
"""åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶"""

class Permission(str, Enum):
    """æƒé™å®šä¹‰"""
    # Agent æƒé™
    AGENT_RUN = "agent:run"
    AGENT_CREATE = "agent:create"
    AGENT_DELETE = "agent:delete"

    # å·¥å…·æƒé™
    TOOL_EXEC = "tool:execute"
    TOOL_MANAGE = "tool:manage"

    # ä¼šè¯æƒé™
    SESSION_READ = "session:read"
    SESSION_WRITE = "session:write"
    SESSION_DELETE = "session:delete"

    # æŠ€èƒ½æƒé™
    SKILL_INSTALL = "skill:install"
    SKILL_PUBLISH = "skill:publish"

    # ç³»ç»Ÿæƒé™
    CONFIG_READ = "config:read"
    CONFIG_WRITE = "config:write"
    AUDIT_READ = "audit:read"

class Role(BaseModel):
    """è§’è‰²å®šä¹‰"""
    name: str
    permissions: list[Permission]
    description: str

# é¢„å®šä¹‰è§’è‰²
BUILTIN_ROLES = {
    "admin": Role(
        name="admin",
        permissions=list(Permission),  # æ‰€æœ‰æƒé™
        description="ç³»ç»Ÿç®¡ç†å‘˜"
    ),
    "user": Role(
        name="user",
        permissions=[
            Permission.AGENT_RUN,
            Permission.TOOL_EXEC,
            Permission.SESSION_READ,
            Permission.SESSION_WRITE,
        ],
        description="æ™®é€šç”¨æˆ·"
    ),
    "readonly": Role(
        name="readonly",
        permissions=[
            Permission.SESSION_READ,
            Permission.CONFIG_READ,
        ],
        description="åªè¯»ç”¨æˆ·"
    )
}

class RBACManager:
    """RBAC ç®¡ç†å™¨"""

    def __init__(self):
        self.roles = BUILTIN_ROLES.copy()
        self.user_roles: dict[str, list[str]] = {}

    def assign_role(self, user_id: str, role_name: str):
        """åˆ†é…è§’è‰²"""
        if role_name not in self.roles:
            raise ValueError(f"è§’è‰²ä¸å­˜åœ¨: {role_name}")

        if user_id not in self.user_roles:
            self.user_roles[user_id] = []

        self.user_roles[user_id].append(role_name)

    def check_permission(
        self,
        user_id: str,
        permission: Permission
    ) -> bool:
        """æ£€æŸ¥æƒé™"""
        user_roles = self.user_roles.get(user_id, [])

        for role_name in user_roles:
            role = self.roles[role_name]
            if permission in role.permissions:
                return True

        return False

    def require_permission(self, permission: Permission):
        """æƒé™è£…é¥°å™¨"""
        def decorator(func):
            async def wrapper(user_id: str, *args, **kwargs):
                if not self.check_permission(user_id, permission):
                    raise PermissionError(
                        f"ç”¨æˆ· {user_id} æ— æƒé™: {permission}"
                    )
                return await func(user_id, *args, **kwargs)
            return wrapper
        return decorator
```

### 5.5 é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ

æ–°å»ºæ–‡ä»¶: `docs/design/HIGH_AVAILABILITY.md`

```markdown
# LurkBot é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ

## æ¶æ„è®¾è®¡

\`\`\`
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è´Ÿè½½å‡è¡¡å±‚                               â”‚
â”‚                  (Nginx / HAProxy)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  LurkBot å®ä¾‹ 1 â”‚  â”‚ LurkBot å®ä¾‹ 2â”‚
        â”‚  (Gateway)      â”‚  â”‚ (Gateway)     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         å…±äº«çŠ¶æ€å±‚                    â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
        â”‚  â”‚  Redis   â”‚     â”‚ PostgreSQLâ”‚      â”‚
        â”‚  â”‚ (ä¼šè¯)   â”‚     â”‚ (å®¡è®¡æ—¥å¿—)â”‚      â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
\`\`\`

## å®æ–½æ­¥éª¤

1. **ä¼šè¯å…±äº«**: ä½¿ç”¨ Redis å­˜å‚¨ä¼šè¯çŠ¶æ€
2. **è´Ÿè½½å‡è¡¡**: Nginx é…ç½® WebSocket æ”¯æŒ
3. **å¥åº·æ£€æŸ¥**: å®ç° `/health` ç«¯ç‚¹
4. **è‡ªåŠ¨æ‰©ç¼©å®¹**: Kubernetes HPA
5. **æ•°æ®å¤‡ä»½**: å®šæ—¶å¤‡ä»½ Redis + PostgreSQL
\`\`\`

---

## å…­ã€å®æ–½è·¯çº¿å›¾

### 6.1 æ€»ä½“è§„åˆ’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LurkBot å¯¹é½å®æ–½è·¯çº¿å›¾                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Phase 1: æ ¸å¿ƒ Skills ç”Ÿæ€å»ºè®¾ (2-3 å‘¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ Step 0: Tools â†’ Skills è½¬æ¢                       [P0] â”‚ â”‚
â”‚  â”‚   â””â”€â”€ ä¸º 22 ä¸ª Tools åˆ›å»º SKILL.md                  2å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ ClawHub é›†æˆ                                        [P0]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ API å®¢æˆ·ç«¯                                     3å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ CLI å‘½ä»¤                                       2å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ Registry æ‰©å±•                                  3å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ Agent è‡ªåŠ¨å®‰è£…                                 2å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ å¼•å…¥ OpenClaw Skills                               [P0]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ é«˜ä¼˜å…ˆçº§ Skills (~10ä¸ª)                        3å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ ä¸­ä¼˜å…ˆçº§ Skills (~20ä¸ª)                        5å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€ æµ‹è¯•éªŒè¯                                            [P0]â”‚ â”‚
â”‚      â”œâ”€â”€ Skills å®‰è£…æµ‹è¯•                                2å¤©  â”‚ â”‚
â”‚      â””â”€â”€ æ–‡æ¡£æ›´æ–°                                       2å¤©  â”‚ â”‚
â”‚                                                              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                                 â”‚
â”‚  Phase 2: å›½å†…ç”Ÿæ€é€‚é… (2-3 å‘¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ å›½å†… IM é€‚é…                                        [P1]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ä¼ä¸šå¾®ä¿¡ Adapter                               5å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ é’‰é’‰ Adapter                                   4å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ é£ä¹¦ Adapter                                   4å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ å›½å†…å¤§æ¨¡å‹é€‚é…                                      [P1]â”‚ â”‚
â”‚  â”‚   â””â”€â”€ DeepSeek/Qwen/Kimi/GLM                         3å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€ æµ‹è¯•éªŒè¯                                            [P0]â”‚ â”‚
â”‚      â””â”€â”€ å›½å†… IM æ¶ˆæ¯æ”¶å‘æµ‹è¯•                            3å¤©  â”‚ â”‚
â”‚                                                              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«                                        [P1]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ProactiveIdentifier                            5å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ Heartbeat é›†æˆ                                 2å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ é€šçŸ¥æœºåˆ¶                                       3å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  Phase 3: è‡ªä¸»èƒ½åŠ›å¢å¼º (2-3 å‘¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«                                        [P1]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ProactiveIdentifier                            5å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ Heartbeat é›†æˆ                                 2å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ é€šçŸ¥æœºåˆ¶                                       3å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ æŠ€èƒ½å­¦ä¹                                             [P2]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ SkillLearningManager                           4å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ä½¿ç”¨ç»Ÿè®¡                                       2å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ æ¨èç®—æ³•                                       3å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€ æµ‹è¯•éªŒè¯                                            [P0]â”‚ â”‚
â”‚      â””â”€â”€ åŠŸèƒ½æµ‹è¯•                                       3å¤©  â”‚ â”‚
â”‚                                                              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                                 â”‚
â”‚  Phase 4: ä¼ä¸šèƒ½åŠ›å¢å¼º (3-4 å‘¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ å®‰å…¨å¢å¼º                                            [P0]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ä¼šè¯åŠ å¯†                                       4å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ç»“æ„åŒ–å®¡è®¡                                     3å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ RBAC æƒé™                                      5å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ æ•æ„Ÿè¯è¿‡æ»¤                                     2å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ é«˜å¯ç”¨éƒ¨ç½²                                          [P1]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ Redis ä¼šè¯å…±äº«                                 3å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ å¥åº·æ£€æŸ¥ç«¯ç‚¹                                   1å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ Docker Compose                                 2å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€ å‰ç«¯å¼€å‘                                            [P2]â”‚ â”‚
â”‚      â”œâ”€â”€ Web Dashboard åŸºç¡€                              10å¤© â”‚ â”‚
â”‚      â””â”€â”€ PWA æ”¯æŒ                                       3å¤©  â”‚ â”‚
â”‚                                                              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                                 â”‚
â”‚  Phase 5: ç”Ÿæ€å®Œå–„ (æŒç»­) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ æ–‡æ¡£å®Œå–„                                            [P1]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ éƒ¨ç½²æŒ‡å—                                       5å¤©  â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ å¼€å‘æ‰‹å†Œ                                       5å¤©  â”‚ â”‚
â”‚  â”‚   â””â”€â”€ API æ–‡æ¡£                                       3å¤©  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”œâ”€â”€ ç¤¾åŒºå»ºè®¾                                            [P2]â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ç¤ºä¾‹é¡¹ç›®                                       æŒç»­ â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ æŠ€èƒ½ç”Ÿæ€                                       æŒç»­ â”‚ â”‚
â”‚  â”‚   â””â”€â”€ ç”¨æˆ·åé¦ˆ                                       æŒç»­ â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€ æŒç»­ä¼˜åŒ–                                            [P3]â”‚ â”‚
â”‚      â”œâ”€â”€ æ€§èƒ½ä¼˜åŒ–                                       æŒç»­ â”‚ â”‚
â”‚      â””â”€â”€ Bug ä¿®å¤                                       æŒç»­ â”‚ â”‚
â”‚                                                              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 å…³é”®é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | äº¤ä»˜ç‰© | éªŒæ”¶æ ‡å‡† | é¢„è®¡å®Œæˆ |
|--------|--------|----------|----------|
| **M0: Toolsâ†’Skills** | 22 ä¸ª SKILL.md | æ‰€æœ‰ Tools å¯é€šè¿‡ Skills æ ¼å¼æè¿° | Week 1 |
| **M1: ClawHub é›†æˆ** | ClawHub å®¢æˆ·ç«¯ + CLI | `lurkbot skills install` æ­£å¸¸å·¥ä½œ | Week 2 |
| **M2: Skills ç”Ÿæ€** | å¼•å…¥ 30 ä¸ª OpenClaw Skills | é«˜ä¼˜å…ˆçº§ Skills å¯ç”¨ | Week 3 |
| **M3: å›½å†… IM é€‚é…** | 3 ä¸ªé¢‘é“é€‚é…å™¨ | ä¼ä¸šå¾®ä¿¡/é’‰é’‰/é£ä¹¦å¯æ”¶å‘æ¶ˆæ¯ | Week 5 |
| **M4: è‡ªä¸»èƒ½åŠ›** | ä¸»åŠ¨ä»»åŠ¡è¯†åˆ« + æŠ€èƒ½å­¦ä¹  | Heartbeat å¯æ¨èä»»åŠ¡ | Week 7 |
| **M5: ä¼ä¸šå®‰å…¨** | åŠ å¯† + å®¡è®¡ + RBAC | ä¼šè¯åŠ å¯†å­˜å‚¨ï¼Œå®¡è®¡æ—¥å¿—å®Œæ•´ | Week 10 |
| **M6: é«˜å¯ç”¨** | Docker Compose + æ–‡æ¡£ | å¯ä¸€é”®éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ | Week 11 |
| **M7: Dashboard** | Web ç®¡ç†ç•Œé¢ | å¯ç®¡ç†ä¼šè¯/Skills/é…ç½® | Week 14 |

### 6.3 ä¾èµ–å…³ç³»å›¾

```
M0 (Toolsâ†’Skills è½¬æ¢)
    â”‚
    â”œâ”€â†’ M1 (ClawHub é›†æˆ)
    â”‚       â”‚
    â”‚       â””â”€â†’ M2 (Skills ç”Ÿæ€)
    â”‚               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
M3 (å›½å†… IM)
    â”‚
    â”œâ”€â†’ M4 (è‡ªä¸»èƒ½åŠ›)
    â”‚       â”‚
    â”‚       â””â”€â†’ M5 (ä¼ä¸šå®‰å…¨)
    â”‚               â”‚
    â”‚               â””â”€â†’ M6 (é«˜å¯ç”¨)
    â”‚                       â”‚
    â”‚                       â””â”€â†’ M7 (Dashboard)
```

**å…³é”®è·¯å¾„**ï¼šM0 â†’ M1 â†’ M2 â†’ M4 â†’ M5 â†’ M6 â†’ M7
**å¹¶è¡Œè·¯å¾„**ï¼šM3 å¯ä¸ M1/M2 å¹¶è¡Œå¼€å‘

---

## ä¸ƒã€é£é™©ç®¡ç†

### 7.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|---------|
| **ClawHub API å˜æ›´** | é«˜ | ä¸­ | ç‰ˆæœ¬é”å®šï¼Œæœ¬åœ°ç¼“å­˜ï¼Œfallback æœºåˆ¶ |
| **å›½å†… IM API é™åˆ¶** | é«˜ | ä¸­ | å¤šç§è®¤è¯æ–¹å¼ï¼Œæµé‡æ§åˆ¶ï¼Œé”™è¯¯é‡è¯• |
| **PydanticAI å…¼å®¹æ€§** | ä¸­ | ä½ | ç‰ˆæœ¬é”å®šï¼Œå……åˆ†æµ‹è¯•ï¼Œä¿æŒä¸Šæ¸¸åŒæ­¥ |
| **æ€§èƒ½ç“¶é¢ˆ** | ä¸­ | ä¸­ | æ€§èƒ½æµ‹è¯•ï¼Œå¼‚æ­¥ä¼˜åŒ–ï¼Œç¼“å­˜ç­–ç•¥ |
| **å®‰å…¨æ¼æ´** | é«˜ | ä½ | ä»£ç å®¡è®¡ï¼Œä¾èµ–æ‰«æï¼ŒåŠæ—¶æ›´æ–° |

### 7.2 ä¸šåŠ¡é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|---------|
| **å›½å†…å†…å®¹å®¡æ ¸** | é«˜ | é«˜ | æ•æ„Ÿè¯è¿‡æ»¤ï¼Œäººå·¥å®¡æ ¸æ¥å£ï¼Œåˆè§„æ–‡æ¡£ |
| **ä¼ä¸šéƒ¨ç½²æƒé™** | ä¸­ | ä¸­ | ç§æœ‰åŒ–éƒ¨ç½²ï¼Œæƒé™éš”ç¦»ï¼Œå®¡è®¡æ—¥å¿— |
| **ç”¨æˆ·æ•°æ®å®‰å…¨** | é«˜ | ä¸­ | åŠ å¯†å­˜å‚¨ï¼Œè®¿é—®æ§åˆ¶ï¼Œå®šæœŸå¤‡ä»½ |
| **OpenClaw åˆ†å‰** | ä½ | ä½ | æ¶æ„è§£è€¦ï¼Œä¿æŒç‹¬ç«‹å‘å±•è·¯çº¿ |

### 7.3 èµ„æºé£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|---------|
| **å¼€å‘äººåŠ›ä¸è¶³** | é«˜ | ä¸­ | ä¼˜å…ˆçº§æ’åºï¼Œé˜¶æ®µæ€§äº¤ä»˜ï¼Œç¤¾åŒºè´¡çŒ® |
| **æµ‹è¯•è¦†ç›–ä¸è¶³** | ä¸­ | ä¸­ | è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ŒCI/CD é›†æˆï¼Œä»£ç å®¡æŸ¥ |
| **æ–‡æ¡£æ»å** | ä¸­ | é«˜ | åŒæ­¥æ›´æ–°ï¼Œæ–‡æ¡£æ¨¡æ¿ï¼Œç¤ºä¾‹é©±åŠ¨ |

---

## å…«ã€æˆåŠŸæ ‡å‡†

### 8.1 Phase 1 éªŒæ”¶æ ‡å‡†

#### Step 0: Tools â†’ Skills è½¬æ¢
```bash
# éªŒè¯ SKILL.md æ–‡ä»¶åˆ›å»ºå®Œæˆ
$ ls skills/*/SKILL.md
skills/exec/SKILL.md
skills/filesystem/SKILL.md
skills/sessions/SKILL.md
skills/memory/SKILL.md
skills/web/SKILL.md
skills/messaging/SKILL.md
skills/automation/SKILL.md
skills/gateway/SKILL.md
skills/media/SKILL.md
skills/nodes/SKILL.md
skills/hooks/SKILL.md

# éªŒè¯ Skills å¯è¢«åŠ è½½
$ lurkbot skills list --source local
âœ… å‘ç° 11 ä¸ªæœ¬åœ° Skills (åŒ…è£… 22 ä¸ª Tools)
```

#### ClawHub é›†æˆ
```bash
# æœç´¢ Skills
$ lurkbot skills search "weather"
âœ… æ‰¾åˆ° 5 ä¸ª Skills

# å®‰è£… Skills
$ lurkbot skills install openclaw/weather-lookup
âœ… å·²å®‰è£…: openclaw/weather-lookup@1.0.0

# åˆ—å‡º Skills
$ lurkbot skills list
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Key             â”‚ æ¥æº     â”‚ å¯ç”¨   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ weather-lookup  â”‚ clawhub  â”‚ âœ…     â”‚
â”‚ filesystem      â”‚ local    â”‚ âœ…     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Skills ç”Ÿæ€å¼•å…¥
```bash
# å®‰è£…é«˜ä¼˜å…ˆçº§ Skills
$ lurkbot skills install openclaw/code-review
$ lurkbot skills install openclaw/file-manager
$ lurkbot skills install openclaw/notion

# éªŒè¯ Skills å¯ç”¨
$ lurkbot skills list --source clawhub
âœ… å·²å®‰è£… 10 ä¸ªé«˜ä¼˜å…ˆçº§ Skills
âœ… å·²å®‰è£… 20 ä¸ªä¸­ä¼˜å…ˆçº§ Skills
```

### 8.2 Phase 2 éªŒæ”¶æ ‡å‡†

#### å›½å†… IM é€‚é…
```bash
# å¯åŠ¨ä¼ä¸šå¾®ä¿¡é¢‘é“
$ lurkbot gateway --channel wework
âœ… ä¼ä¸šå¾®ä¿¡é¢‘é“å·²å¯åŠ¨

# å‘é€æµ‹è¯•æ¶ˆæ¯
[ç”¨æˆ·] ä½ å¥½
[Bot]  ä½ å¥½ï¼æˆ‘æ˜¯ LurkBotï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ ï¼Ÿ

# éªŒè¯ Markdown æ”¯æŒ
[ç”¨æˆ·] æ˜¾ç¤ºä»£ç 
[Bot]  ```python
       def hello():
           print("Hello!")
       ```
```

### 8.3 Phase 3 éªŒæ”¶æ ‡å‡†

### 8.3 Phase 3 éªŒæ”¶æ ‡å‡†

#### ä¸»åŠ¨ä»»åŠ¡è¯†åˆ«
```
[Heartbeat 10:00] æ£€æµ‹åˆ° 3 ä¸ªå¾…å¤„ç†ä»»åŠ¡:
1. [P5] é‡è¯•å¤±è´¥çš„æ–‡ä»¶å¤‡ä»½
2. [P3] å›å¤ Alice çš„é‚®ä»¶
3. [P2] å‡†å¤‡æ˜å¤©ä¼šè®®ææ–™

æ˜¯å¦éœ€è¦æˆ‘ååŠ©å¤„ç†è¿™äº›ä»»åŠ¡ï¼Ÿ
```

#### æŠ€èƒ½æ¨è
```
[Agent] ä½ å¯èƒ½éœ€è¦ "code-review" æŠ€èƒ½æ¥å¸®åŠ©å®¡æŸ¥ä»£ç ã€‚
        å®‰è£…å‘½ä»¤: lurkbot skills install code-review

        æ˜¯å¦ç°åœ¨å®‰è£…ï¼Ÿ
[ç”¨æˆ·] æ˜¯
[Agent] âœ… å·²å®‰è£… code-review æŠ€èƒ½
```

### 8.4 Phase 4 éªŒæ”¶æ ‡å‡†

#### å®‰å…¨å¢å¼º
```bash
# éªŒè¯åŠ å¯†
$ ls ~/.lurkbot/agents/default/sessions/
session-abc123.enc  # âœ… åŠ å¯†æ–‡ä»¶

# éªŒè¯å®¡è®¡æ—¥å¿—
$ lurkbot audit search --action tool.execute --user alice
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ—¶é—´                 â”‚ ç”¨æˆ·     â”‚ å·¥å…·    â”‚ ç»“æœ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2026-01-31 10:15:23  â”‚ alice    â”‚ exec    â”‚ æˆåŠŸ   â”‚
â”‚ 2026-01-31 10:16:45  â”‚ alice    â”‚ web_searchâ”‚æˆåŠŸ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# éªŒè¯ RBAC
$ lurkbot user assign-role bob readonly
âœ… å·²åˆ†é…è§’è‰² "readonly" ç»™ç”¨æˆ· bob

$ lurkbot --user bob agent run "åˆ é™¤æ‰€æœ‰æ–‡ä»¶"
âŒ é”™è¯¯: ç”¨æˆ· bob æ— æƒé™: tool:execute
```

#### é«˜å¯ç”¨éƒ¨ç½²
```bash
# Docker Compose éƒ¨ç½²
$ docker-compose up -d
âœ… åˆ›å»ºæœåŠ¡: lurkbot-1, lurkbot-2, redis, postgres, nginx

# å¥åº·æ£€æŸ¥
$ curl http://localhost:18789/health
{
  "status": "healthy",
  "version": "1.0.0",
  "uptime": 3600,
  "instances": 2
}
```

### 8.4 æœ€ç»ˆéªŒæ”¶

| æŒ‡æ ‡ | ç›®æ ‡ | éªŒè¯æ–¹å¼ |
|------|------|----------|
| **Tools å®Œæ•´åº¦** | 22/22 (100%) | âœ… å·²å®Œæˆ |
| **Skills ç”Ÿæ€** | 30/52 (58%) | Skills å®‰è£…æµ‹è¯• |
| **åŠŸèƒ½å®Œæ•´åº¦** | 95%+ | åŠŸèƒ½æ¸…å•è¦†ç›– |
| **æµ‹è¯•è¦†ç›–ç‡** | 85%+ | pytest-cov |
| **æ€§èƒ½** | å¯åŠ¨ < 2s | æ€§èƒ½æµ‹è¯• |
| **æ–‡æ¡£å®Œæ•´æ€§** | 100% | æ–‡æ¡£æ¸…å• |
| **å®‰å…¨å®¡è®¡** | æ— é«˜å±æ¼æ´ | bandit + safety |

---

## é™„å½• A: å…³é”®æ–‡ä»¶æ¸…å•

### éœ€æ–°å»ºçš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ | Phase |
|---------|------|-------|
| `skills/exec/SKILL.md` | exec + process Tools åŒ…è£… | Phase 1 |
| `skills/filesystem/SKILL.md` | read/write/edit/patch Tools åŒ…è£… | Phase 1 |
| `skills/sessions/SKILL.md` | 6 ä¸ª session Tools åŒ…è£… | Phase 1 |
| `skills/memory/SKILL.md` | memory Tools åŒ…è£… | Phase 1 |
| `skills/web/SKILL.md` | web Tools åŒ…è£… | Phase 1 |
| `skills/messaging/SKILL.md` | message Tool åŒ…è£… | Phase 1 |
| `skills/automation/SKILL.md` | cron Tool åŒ…è£… | Phase 1 |
| `skills/gateway/SKILL.md` | gateway Tool åŒ…è£… | Phase 1 |
| `skills/media/SKILL.md` | image/tts Tools åŒ…è£… | Phase 1 |
| `skills/nodes/SKILL.md` | nodes Tool åŒ…è£… | Phase 1 |
| `skills/hooks/SKILL.md` | hooks Tool åŒ…è£… | Phase 1 |
| `src/lurkbot/skills/clawhub.py` | ClawHub å®¢æˆ·ç«¯ | Phase 1 |
| `src/lurkbot/skills/learning.py` | æŠ€èƒ½å­¦ä¹ ç®¡ç† | Phase 3 |
| `src/lurkbot/cli/skills.py` | skills CLI å‘½ä»¤ | Phase 1 |
| `src/lurkbot/channels/wework/` | ä¼ä¸šå¾®ä¿¡é€‚é…å™¨ | Phase 2 |
| `src/lurkbot/channels/dingtalk/` | é’‰é’‰é€‚é…å™¨ | Phase 2 |
| `src/lurkbot/channels/feishu/` | é£ä¹¦é€‚é…å™¨ | Phase 2 |
| `src/lurkbot/autonomous/proactive/` | ä¸»åŠ¨ä»»åŠ¡è¯†åˆ« | Phase 3 |
| `src/lurkbot/security/encryption.py` | ä¼šè¯åŠ å¯† | Phase 4 |
| `src/lurkbot/security/audit.py` | ç»“æ„åŒ–å®¡è®¡ | Phase 4 |
| `src/lurkbot/security/rbac.py` | RBAC æƒé™ | Phase 4 |
| `src/lurkbot/dashboard/` | Web Dashboard | Phase 4 |

### éœ€ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | ä¿®æ”¹å†…å®¹ | Phase |
|---------|----------|-------|
| `src/lurkbot/skills/registry.py` | æ·»åŠ  ClawHub é›†æˆ | Phase 1 |
| `src/lurkbot/agents/runtime.py` | æ·»åŠ  Skills è‡ªåŠ¨å®‰è£… | Phase 1 |
| `src/lurkbot/config/channels.py` | æ·»åŠ å›½å†… IM é…ç½® | Phase 2 |
| `src/lurkbot/config/models.py` | æ·»åŠ å›½å†…å¤§æ¨¡å‹ | Phase 2 |
| `src/lurkbot/sessions/store.py` | æ”¯æŒåŠ å¯†å­˜å‚¨ | Phase 4 |
| `pyproject.toml` | æ·»åŠ ä¾èµ– | Phase 1-4 |
| `docker-compose.yml` | é«˜å¯ç”¨é…ç½® | Phase 4 |

---

## é™„å½• B: ä¾èµ–æ›´æ–°

```toml
# pyproject.toml

[project.dependencies]
# ... ç°æœ‰ä¾èµ– ...

# Phase 1: ClawHub & å›½å†… IM
httpx = ">=0.27.0"           # ClawHub API å®¢æˆ·ç«¯
wechatpy = ">=2.0.0"         # ä¼ä¸šå¾®ä¿¡ SDK
dingtalk-sdk = ">=2.0.0"     # é’‰é’‰ SDK
lark-oapi = ">=1.3.0"        # é£ä¹¦ SDK

# Phase 3: å®‰å…¨å¢å¼º
cryptography = ">=43.0.0"    # åŠ å¯†åº“
redis = ">=5.0.0"            # ä¼šè¯å…±äº«
sqlalchemy = ">=2.0.0"       # å®¡è®¡æ—¥å¿—å­˜å‚¨
alembic = ">=1.13.0"         # æ•°æ®åº“è¿ç§»

[project.optional-dependencies]
# å›½å†…é¢‘é“
cn-channels = [
    "wechatpy>=2.0.0",
    "dingtalk-sdk>=2.0.0",
    "lark-oapi>=1.3.0",
]

# ä¼ä¸šéƒ¨ç½²
enterprise = [
    "cryptography>=43.0.0",
    "redis>=5.0.0",
    "sqlalchemy>=2.0.0",
    "psycopg2-binary>=2.9.0",
]

# é«˜å¯ç”¨
high-availability = [
    "redis>=5.0.0",
    "prometheus-client>=0.20.0",
]
```

---

**æ–‡æ¡£ç»“æŸ**

> **ç‰ˆæœ¬**: v2.0 (é‡å¤§æ›´æ–°ï¼šæ¾„æ¸… Tools vs Skills æ¦‚å¿µå·®å¼‚)
> **æ—¥æœŸ**: 2026-01-31
> **ä½œè€…**: Claude (Sonnet 4.5)
> **å®¡æ ¸**: å¾…å®¡æ ¸
>
> **v2.0 æ›´æ–°è¯´æ˜**:
> - æ¾„æ¸…æ ¸å¿ƒæ¦‚å¿µï¼šLurkBot çš„ 22 ä¸ª "skills" å®é™…æ˜¯ **Tools**ï¼ˆç³»ç»Ÿçº§åŸå­åŠŸèƒ½ï¼‰
> - æ›´æ–°å¯¹é½ç›®æ ‡ï¼šä»"å®ç°ç¼ºå¤± Tools"è°ƒæ•´ä¸º"å»ºè®¾ Skills ç”Ÿæ€"
> - æ–°å¢ Step 0ï¼šå°†ç°æœ‰ Tools è½¬æ¢ä¸º SKILL.md æ ¼å¼
> - è°ƒæ•´å®æ–½è·¯çº¿ï¼šä¼˜å…ˆå®Œæˆ Toolsâ†’Skills è½¬æ¢å’Œ ClawHub é›†æˆ
> - æ›´æ–°æ‰€æœ‰éªŒæ”¶æ ‡å‡†ä»¥åæ˜ æ­£ç¡®çš„ Tools/Skills æœ¯è¯­
